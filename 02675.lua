
------------------------------------------------------------------------¤H¤ı¶Ç³ê
function Z23_Quest425210_00()
	if CheckFlag( TargetID(), 546506)==False and
	CheckFlag( TargetID(), 546507)==False then
		GiveBodyItem( TargetID(), 546506, 1 )--¤H¤ı¶Ç³ê
		GiveBodyItem( TargetID(), 546507, 1 )--©¬´¶¡D»®¯Á¤Ò
	end
end
------------------------------------------------------------------------
function Z23_Quest425210_01()
	Lua_ZonePE_3th_GetScore(50)
	SetFlag( TargetID(), 546507, 0 )
	local Controller=SearchRangeNPC( OwnerID(), 200 )
	for i=0,table.getn( Controller ) do
		if ReadRoleValue( Controller[i] , EM_RoleValue_OrgID)==120273 then
			if ReadRoleValue( Controller[i], EM_RoleValue_Register1)==0 then
				CallPlot( Controller[i] , "Z23_Quest425210_02", Controller[i] )
			else 	return
			end
		end
	end
end
------------------------------------------------------------------------
function Z23_Quest425210_02()
	local Controller=OwnerID()
	WriteRoleValue( Controller, EM_RoleValue_Register1 , 1 )
	local NPC= CreateObjByFlag( 120781, 781147, 0 , 1 )
	SetModeEx( NPC, EM_SetModeType_Searchenemy , false )
	SetModeEx( NPC, EM_SetModeType_Fight , false )
	SetModeEx( NPC, EM_SetModeType_Strikback , false )
	SetModeEx( NPC, EM_SetModeType_ShowRoleHead , false )
	SetModeEx( NPC, EM_SetModeType_Mark , false )
	SetModeEx( NPC, EM_SetModeType_HideName , true )
	SetModeEx( NPC, EM_SetModeType_Move , true )
	SetModeEx( NPC, EM_SetModeType_NotShowHPMP, true )
	SetModeEx( NPC, EM_SetModeType_Gravity, true )
	SetModeEx( NPC, EM_SetModeType_Save, true )
	WriteRoleValue( NPC, EM_RoleValue_IsWalk , 0  )
	AddToPartition( NPC, 0 )
	CallPlot( NPC, "Z23_NPC120828_00", NPC, Controller )
end
------------------------------------------------------------------------
function Z23_NPC120828_00( NPC, Controller )--³q³ø¤h§L
	MoveToFlagEnabled( NPC, false )
	local Captain=SearchRangeNPC( NPC, 250 )
	local ACT01 =0
	local ACT02 =0
	for i=0,table.getn( Captain ) do
		if ReadRoleValue( Captain[i] , EM_RoleValue_OrgID)==120273 then
			ACT01=Captain[i]
		elseif ReadRoleValue( Captain[i] , EM_RoleValue_OrgID)==120825 then
			ACT02=Captain[i]
		end
	end
	AdjustFaceDir( NPC, ACT01, 0 )
	AdjustFaceDir( NPC, ACT02, 0 )
	AdjustFaceDir( ACT01, NPC, 0 )
	AdjustFaceDir( ACT02, NPC, 0 )
	NpcSay( ACT01, "[SC_425210_01]" )--¨¾½u¦ü¥G¦³¤°»òª¬ªp....¡I
	NpcSay( ACT02, "[SC_425210_01]" )--¨¾½u¦ü¥G¦³¤°»òª¬ªp....¡I
	Sleep(20)
	NpcSay( NPC, "[SC_425210_02]" )--¶¤ªø....¤£¦n¤F¡I
	LuaFunc_MoveToFlag( NPC, 781147, 1, 0 )
	Sleep(10)		 
	NpcSay( NPC, "[SC_425210_03]" )--¼Ä¤H¤w¬ğ¯}§Ú­xªº¨¾½u¡A«ü´§©Ò±N·|ÀH®É¾D¨ì§ğÀ»....¡I
	Sleep(35)
	NpcSay( ACT01, "[SC_425210_04]" )--­ó.....¨e­Ì´±¡I
	NpcSay( ACT02, "[SC_425210_04]" )--­ó.....¨e­Ì´±¡I
	Sleep(10)
	WriteRoleValue( Controller, EM_RoleValue_Register1 , 0 )
	DelObj ( NPC )
end
------------------------------------------------------------------------
function Z23_NPC120779_00()--¥d©Ôºû¡D¥dÂÄ©i
	SetPlot( OwnerID(),"range","Z23_NPC120779_01",100 )
	MoveToFlagEnabled( OwnerID(), false )
	local ACT={}
	local NPC=SearchRangeNPC(OwnerID(), 100)
	for i=0,table.getn(NPC) do
		if ReadRoleValue( NPC[i] , EM_RoleValue_OrgID)==120822 then ACT[1]= NPC[i] end--³Ç´µ¡D²ö§J¨½¤Ò
		if ReadRoleValue( NPC[i] , EM_RoleValue_OrgID)==120823 then ACT[2]= NPC[i] end--¥ì±Z©g¡D¦N©ù¯S
	end
	while 1 do
	PlayMotion(OwnerID(),ruFUSION_ACTORSTATE_EMOTE_SPEAK) 
	local Num=Rand(50)
		if Num> 0 and Num<= 25 then
			AdjustFaceDir( OwnerID(), ACT[1], 0 )
			PlayMotion(OwnerID(),ruFUSION_ACTORSTATE_EMOTE_SPEAK)
			Sleep(Num)
		end
		if Num> 26 and Num<= 50 then
			AdjustFaceDir( OwnerID(), ACT[2], 0 )
			PlayMotion(OwnerID(),ruFUSION_ACTORSTATE_EMOTE_SPEAK)
			Sleep(Num)
		end
	Sleep(30)
	end
end
------------------------------------------------------------------------
function Z23_NPC120779_01()--¥d©Ôºû¡D¥dÂÄ©i
	if CheckAcceptQuest( OwnerID(), 425210)==TRUE
	and CheckFlag( OwnerID(), 546292)==False then
	GiveBodyItem( OwnerID(), 546292, 1 )
	end
end
------------------------------------------------------------------------
function Z23_NPC120779_02()--¥d©Ôºû¡D¥dÂÄ©i
	if CheckAcceptQuest( OwnerID(), 425210)==TRUE
	and CheckFlag( OwnerID(), 546292)==False then
	GiveBodyItem( OwnerID(), 546292, 1 )
	end
	LoadQuestOption( OwnerID() )
end
------------------------------------------------------------------------
function NPC120822_00()--³Ç´µ¡D²ö§J¨½¤Ò
	MoveToFlagEnabled( OwnerID(), false )
	local ACT={}
	local NPC=SearchRangeNPC(OwnerID(), 100)
	for i=0,table.getn(NPC) do
		if ReadRoleValue( NPC[i] , EM_RoleValue_OrgID)==120820 then ACT[1]= NPC[i] end--¼¯·ç§J¡D´ìªL¯S
		if ReadRoleValue( NPC[i] , EM_RoleValue_OrgID)==120823 then ACT[2]= NPC[i] end--¥ì±Z©g¡D¦N©ù¯S
	end
	while 1 do
	PlayMotion(OwnerID(),ruFUSION_ACTORSTATE_EMOTE_SPEAK) 
	local Num=Rand(50)
		if Num> 0 and Num<= 25 then
			AdjustFaceDir( OwnerID(), ACT[1], 0 )
			PlayMotion(OwnerID(),ruFUSION_ACTORSTATE_EMOTE_SPEAK)
			Sleep(Num)
		end
		if Num> 26 and Num<= 50 then
			AdjustFaceDir( OwnerID(), ACT[2], 0 )
			PlayMotion(OwnerID(),ruFUSION_ACTORSTATE_EMOTE_SPEAK)
			Sleep(Num)
		end
	Sleep(30)
	end
end
------------------------------------------------------------------------
function NPC120823_00()--¥ì±Z©g¡D¦N©ù¯S
	MoveToFlagEnabled( OwnerID(), false )
	local ACT={}
	local NPC=SearchRangeNPC(OwnerID(), 100)
	for i=0,table.getn(NPC) do
		if ReadRoleValue( NPC[i] , EM_RoleValue_OrgID)==120779 then ACT[1]= NPC[i] end--¥d©Ôºû¡D¥dÂÄ©i
		if ReadRoleValue( NPC[i] , EM_RoleValue_OrgID)==120822 then ACT[2]= NPC[i] end--³Ç´µ¡D²ö§J¨½¤Ò
	end
	while 1 do
	PlayMotion(OwnerID(),ruFUSION_ACTORSTATE_EMOTE_SPEAK) 
	local Num=Rand(50)
		if Num> 0 and Num<= 25 then
			AdjustFaceDir( OwnerID(), ACT[1], 0 )
			PlayMotion(OwnerID(),ruFUSION_ACTORSTATE_EMOTE_SPEAK)
			Sleep(Num)
		end
		if Num> 26 and Num<= 50 then
			AdjustFaceDir( OwnerID(), ACT[2], 0 )
			PlayMotion(OwnerID(),ruFUSION_ACTORSTATE_EMOTE_SPEAK)
			Sleep(Num)
		end
	Sleep(30)
	end
end
------------------------------------------------------------------------
function NPC120824_00()--«Âº¸¡D§¢©_´µ
	MoveToFlagEnabled( OwnerID(), false )
	local ACT={}
	local NPC=SearchRangeNPC(OwnerID(), 100)
	for i=0,table.getn(NPC) do
		if ReadRoleValue( NPC[i] , EM_RoleValue_OrgID)==120822 then ACT[2]= NPC[i] end--³Ç´µ¡D²ö§J¨½¤Ò
		if ReadRoleValue( NPC[i] , EM_RoleValue_OrgID)==120823 then ACT[1]= NPC[i] end--¥ì±Z©g¡D¦N©ù¯S
	end
	while 1 do
	PlayMotion(OwnerID(),ruFUSION_ACTORSTATE_EMOTE_SPEAK) 
	local Num=Rand(50)
		if Num> 0 and Num<= 25 then
			AdjustFaceDir( OwnerID(), ACT[1], 0 )
			PlayMotion(OwnerID(),ruFUSION_ACTORSTATE_EMOTE_SPEAK)
			Sleep(Num)
		end
		if Num> 26 and Num<= 50 then
			AdjustFaceDir( OwnerID(), ACT[2], 0 )
			PlayMotion(OwnerID(),ruFUSION_ACTORSTATE_EMOTE_SPEAK)
			Sleep(Num)
		end
	Sleep(30)
	end
end
------------------------------------------------------------------------
function NPC120825_00()--©¬´¶¡D»®¯Á¤Ò
	MoveToFlagEnabled( OwnerID(), false )
	local ACT={}
	local NPC=SearchRangeNPC(OwnerID(), 100)
	for i=0,table.getn(NPC) do
		if ReadRoleValue( NPC[i] , EM_RoleValue_OrgID)==120779 then ACT[1]= NPC[i] end--¥d©Ôºû¡D¥dÂÄ©i
		if ReadRoleValue( NPC[i] , EM_RoleValue_OrgID)==120822 then ACT[2]= NPC[i] end--³Ç´µ¡D²ö§J¨½¤Ò
		if ReadRoleValue( NPC[i] , EM_RoleValue_OrgID)==120823 then ACT[3]= NPC[i] end--¥ì±Z©g¡D¦N©ù¯S
		if ReadRoleValue( NPC[i] , EM_RoleValue_OrgID)==120824 then ACT[4]= NPC[i] end--«Âº¸¡D§¢©_´µ
	end
	AdjustFaceDir( OwnerID(), ACT[1], 0 )
	while 1 do
		local Num=Rand(8)+1
		if Num==1 then AdjustFaceDir( OwnerID(), ACT[1], 0 ) end
		if Num==2 then AdjustFaceDir( OwnerID(), ACT[2], 0 ) end
		if Num==3 then AdjustFaceDir( OwnerID(), ACT[3], 0 ) end
		if Num==4 then AdjustFaceDir( OwnerID(), ACT[4], 0 ) end
		PlayMotion(OwnerID(),ruFUSION_ACTORSTATE_EMOTE_SPEAK)
		Sleep(30)
	end
end
------------------------------------------------------------------------¾Ô¨Æ§i«æ
function Z23_NPC120273_00()--©¬´¶¡D»®¯Á¤Ò
	WriteRoleValue( OwnerID(), EM_RoleValue_Register1 , 0)
	WriteRoleValue( OwnerID(), EM_RoleValue_Register2 , 0)
end
------------------------------------------------------------------------
function Z23_Quest425211_00()
	CancelBuff( TargetID(), 622649)
	SetModeEx( OwnerID(), EM_SetModeType_ShowRoleHead, False )
	GiveBodyItem( TargetID(), 546508, 1 )
	DelBodyItem( TargetID(), 546506, 1 )
	ScriptMessage( OwnerID(), TargetID(), 2, "[SC_425211_00]", C_SYSTEM )
	if ReadRoleValue( OwnerID(), EM_RoleValue_Register2)==0 then
		WriteRoleValue( OwnerID(), EM_RoleValue_Register2 , 1 )
		local x=ReadRoleValue(OwnerID(),EM_RoleValue_X)
		local y=ReadRoleValue(OwnerID(),EM_RoleValue_Y)
		local z=ReadRoleValue(OwnerID(),EM_RoleValue_Z)
		local location={x, y, z}
		local NPC=Lua_DW_CreateObj( "xyz" , 120784, location, 0, 1, 1 )--¬ğÅ§¤¤±±¾¹
		SetModeEx( NPC, EM_SetModeType_Searchenemy , false )
		SetModeEx( NPC, EM_SetModeType_Fight , false )
		SetModeEx( NPC, EM_SetModeType_Strikback , false )
		SetModeEx( NPC, EM_SetModeType_ShowRoleHead , false )
		SetModeEx( NPC, EM_SetModeType_Mark , false )
		SetModeEx( NPC, EM_SetModeType_HideName , true )
		SetModeEx( NPC, EM_SetModeType_Move , false )
		SetModeEx( NPC, EM_SetModeType_NotShowHPMP, true )
		SetModeEx( NPC, EM_SetModeType_Gravity, true )
		SetModeEx( NPC, EM_SetModeType_Save, false )
		AddToPartition( NPC , 0 )
		WriteRoleValue( NPC, EM_RoleValue_Register1, OwnerID() )
	end
	Sleep(10)
	SetModeEx( OwnerID(), EM_SetModeType_ShowRoleHead, True )
end
------------------------------------------------------------------------
function Z23_NPC120784_00()--¬ğÅ§¤¤±±¾¹
	local KillID=SearchRangeNPC(OwnerID(), 500)--§R°£³õ¤W©Çª«
		for j=0, table.getn(KillID) do
			if ReadRoleValue( KillID[j] , EM_RoleValue_OrgID)==106611 or
			ReadRoleValue( KillID[j] , EM_RoleValue_OrgID)==106612 then
				DelObj( KillID[j] )
			end
		end
	CallPlot( OwnerID(), "Z23_NPC120784_01", OwnerID())--²£¥Í»P·s¼W©Çª«
	CallPlot( OwnerID(), "Z23_NPC120784_02", OwnerID())--¥ô°È­p®É¾¹
	CallPlot( OwnerID(), "Z23_NPC120784_03", OwnerID())--¥ô°È¥¢±ÑÀË¬d
end
------------------------------------------------------------------------
function Z23_NPC120784_01()--²£¥Í»P·s¼W©Çª«
	local Fighter={106611, 106612}
	local NPC={}
	NPC[1]= CreateObjByFlag( Fighter[1], 781151, 1, 1 )--±j¤Æ§ï³y¾Ô¤h
	NPC[2]= CreateObjByFlag( Fighter[2], 781151, 2, 1 )--ºë¾U§ï³y¾Ô¤h
	NPC[3]= CreateObjByFlag( Fighter[2], 781151, 3, 1 )--ºë¾U§ï³y¾Ô¤h
	NPC[4]= CreateObjByFlag( Fighter[1], 781151, 4, 1 )--±j¤Æ§ï³y¾Ô¤h
	Sleep(20)
	for k=1, 4, 1 do
		AddToPartition( NPC[k], 0 )
		WriteRoleValue( NPC[k], EM_RoleValue_Register1, 1 )
		CallPlot( NPC[k], "Z23_MonsterSet425211_00", NPC[k] )
	end
	for j=1, 10, 1 do
		Sleep(50)
		local Num=0
		local Monster=SearchRangeNPC(OwnerID(), 500)
		for i=0,table.getn(Monster) do
			if ReadRoleValue( Monster[i] , EM_RoleValue_OrgID)==106611 or
			ReadRoleValue( Monster[i] , EM_RoleValue_OrgID)==106612 then
				Num=Num+1
			end
		end
		if Num<=8 then
			local location=Rand(4)+1
			local X=Rand(2)+1
			local NewNPC=CreateObjByFlag( Fighter[X], 781151, location, 1)
			WriteRoleValue( NewNPC, EM_RoleValue_Register1, 1 )
			AddToPartition( NewNPC, 0 )
			CallPlot(NewNPC, "Z23_MonsterSet425211_00",NewNPC)
		end
	end
end
------------------------------------------------------------------------
function Z23_NPC120784_02()
	local Captain=ReadRoleValue( OwnerID(), EM_RoleValue_Register1 )
	Sleep(500)
	DelFromPartition( Captain )
	ReSetNPCInfo( Captain )
	AddToPartition( Captain, 0 )
	WriteRoleValue( Captain, EM_RoleValue_Register1 , 0 )
	WriteRoleValue( Captain, EM_RoleValue_Register2 , 0 )
	DelObj( OwnerID() )
end
------------------------------------------------------------------------
function Z23_NPC120784_03()
	while 1 do
		local Num=0--«Å§i1­Ó­p¦¸¥ÎÅÜ¼Æ
		local Monster=SearchRangeNPC( OwnerID(), 450 )--´M§ä¼@±¡¼vÅT½d³ò¤ºªº¬ÛÃö©Çª«¼Æ¶q
		for i=0,table.getn(Monster) do--¨Ï¥Î°j°é¨ú±o¬ÛÃö©Çª«¼Æ¶qÁ`¼Æ
			if ReadRoleValue( Monster[i] , EM_RoleValue_OrgID)==106611 or
			ReadRoleValue( Monster[i] , EM_RoleValue_OrgID)==106612 then
				Num=Num+1
			end
		end
		if Num>=9 then--·í¼@±¡¼vÅT½d³ò¤ºªº¬ÛÃö©Çª«Á`¼Æ¤j©ó©Îµ¥©ó9®É°õ¦æ¥H¤U¦æ¬°
			local Player=SearchRangePlayer( OwnerID(), 500 )--§PÂ_¥ô°È¥¢±Ñ°T®§ªºÅã¥Ü¹ï¶H
			for i=0,table.getn(Player) do
				if CheckAcceptQuest( Player[i], 425211 )==TRUE then--¾Ö¦³¥ô°È425211ªÌ¥B
					if CheckScriptFlag( Player[i], 546293 )==false then--¾Ö¦³­«­nª««~546293ªÌ¦C¬°Åã¥Ü¹ï¶H
						CancelBuff( Player[i], 622649)--³Q¦C¬°¥ô°È¥¢±ÑªÌ§R°£¨ä¨­¤Wªº­p¦¸Buff
						ScriptMessage( OwnerID(), Player[i], 2, "[SC_425211_01]", C_SYSTEM )--Åã¥Ü¥ô°È¥¢±Ñ°T®§
					end
				end		
			end
			local KillID=SearchRangeNPC(OwnerID(), 500)--§R°£³õ¤W©Çª«
			for j=0, table.getn(KillID) do
				if ReadRoleValue( KillID[j] , EM_RoleValue_OrgID)==106611 or
				ReadRoleValue( KillID[j] , EM_RoleValue_OrgID)==106612 then
					DelObj( KillID[j] )
				end
			end
			local Captain=ReadRoleValue( OwnerID(), EM_RoleValue_Register1 )--­«¸m¥ô°ÈNPC¨­¤Wªº¼@±¡±Ò°Ê¶}Ãö
			WriteRoleValue( Captain, EM_RoleValue_Register1 , 0 )--°õ¦æ«e¸m¥ô°È¼@±¡ªº¶}Ãö0¬°¥i¥H°õ¦æ
			WriteRoleValue( Captain, EM_RoleValue_Register2 , 0 )--²£¥Í¤¤±±¾¹ªº¶}Ãö0¬°¥i¥H²£¥Í¤¤±±¾¹
			DelObj( OwnerID() )--§R°£¦Û¤v(¤¤±±¾¹120784)
		end
	sleep(20)
	end
end
------------------------------------------------------------------------
function Z23_NPCSet425211_00()
	MoveToFlagEnabled( OwnerID(), false )
	SetModeEx( OwnerID(), EM_SetModeType_Searchenemy ,false )
	SetModeEx( OwnerID(), EM_SetModeType_Fight ,false )
	SetModeEx( OwnerID(), EM_SetModeType_Strikback ,false )
	SetModeEx( OwnerID(), EM_SetModeType_ShowRoleHead ,true )
	SetModeEx( OwnerID(), EM_SetModeType_Mark ,true )
	SetModeEx( OwnerID(), EM_SetModeType_HideName ,false)
	SetModeEx( OwnerID(), EM_SetModeType_Move ,false )
	SetModeEx( OwnerID(), EM_SetModeType_NotShowHPMP, false )
	SetModeEx( OwnerID(), EM_SetModeType_Gravity, true )
	SetModeEx( OwnerID(), EM_SetModeType_Save, true )

	if ReadRoleValue( OwnerID(), EM_RoleValue_OrgID)==120785 then
		PlayMotionEX( OwnerID(),ruFUSION_ACTORSTATE_COMBAT_1H, ruFUSION_ACTORSTATE_COMBAT_1H)
	end
	if ReadRoleValue( OwnerID(), EM_RoleValue_OrgID)==120786 then
		PlayMotionEX( OwnerID(),ruFUSION_ACTORSTATE_COMBAT_UNARMED, ruFUSION_ACTORSTATE_COMBAT_UNARMED)
	end
	if ReadRoleValue( OwnerID(), EM_RoleValue_OrgID)==120787 then
		PlayMotionEX( OwnerID(),ruFUSION_ACTORSTATE_COMBAT_UNARMED, ruFUSION_ACTORSTATE_COMBAT_UNARMED)
	end
	if ReadRoleValue( OwnerID(), EM_RoleValue_OrgID)==120788 then
		PlayMotionEX( OwnerID(),ruFUSION_ACTORSTATE_COMBAT_2H, ruFUSION_ACTORSTATE_COMBAT_2H)
	end
	if ReadRoleValue( OwnerID(), EM_RoleValue_OrgID)==120826 then
		PlayMotionEX( OwnerID(),ruFUSION_ACTORSTATE_COMBAT_2H, ruFUSION_ACTORSTATE_COMBAT_2H)
	end
	if ReadRoleValue( OwnerID(), EM_RoleValue_OrgID)==120829 then
		PlayMotionEX( OwnerID(),ruFUSION_ACTORSTATE_COMBAT_1H, ruFUSION_ACTORSTATE_COMBAT_1H) end
	end
------------------------------------------------------------------------
function Z23_MonsterSet425211_00()
	while 1 do
		LuaFunc_MoveToFlag( OwnerID(), 781147, 1, 40 )
		Sleep(50)
	end
end
------------------------------------------------------------------------±qªø­pÄ³
function Z23_NPC120780_00()--¥d©Ôºû¡D¥dÂÄ©i
	SetPlot( OwnerID(),"range","Z23_Quest425212_02",100 )
end
------------------------------------------------------------------------
function Z23_NPC120780_01()
	if 	CheckAcceptQuest( OwnerID(), 425212)==TRUE and
		CheckFlag( OwnerID(), 546294)==False then
		GiveBodyItem( OwnerID(), 546294, 1 )
	end
	LoadQuestOption( OwnerID() )
end
------------------------------------------------------------------------
function Z23_Quest425212_00()
	if CheckFlag( TargetID(), 546509)==False then
		GiveBodyItem( TargetID(), 546509, 1 )
	end
end
------------------------------------------------------------------------
function Z23_Quest425212_01()
	Lua_ZonePE_3th_GetScore(50)
	if CheckFlag( TargetID(), 546509)==True then
		DelBodyItem( TargetID(), 546509, 1 )
	end
end
------------------------------------------------------------------------
function Z23_Quest425212_02()
	if CheckAcceptQuest( OwnerID(), 425212)==TRUE and
	CheckFlag( OwnerID(), 546294)==False then
		local Controller={}
		Controller=SearchRangeNPC ( TargetID(), 100 )
		for i=0,table.getn(Controller) do
			if ReadRoleValue( Controller[i] , EM_RoleValue_OrgID)==120856 then
				ScriptMessage( TargetID(), OwnerID(), 2, "[SC_425212_00]", C_SYSTEM )
				CallPlot( Controller[i], "Z23_Quest425212_03", Controller[i])
			end
		end
	end
end
------------------------------------------------------------------------
function Z23_Quest425212_03()
	if ReadRoleValue( OwnerID(), EM_RoleValue_Register1)==0 then
		WriteRoleValue( OwnerID(), EM_RoleValue_Register1, 1 )
		CallPlot( OwnerID(), "Z23_Quest425212_04",OwnerID())
		local SCMD01=CreateObjByFlag( 120858, 781153, 1 , 1 )
		local SCMD02=CreateObjByFlag( 120858, 781153, 2 , 1 )
		local SCMD03=CreateObjByFlag( 120858, 781153, 3 , 1 )
		local SCMD04=CreateObjByFlag( 120858, 781153, 4 , 1 )
		local SCMD05=CreateObjByFlag( 120858, 781153, 5 , 1 )
		MoveToFlagEnabled( SCMD01, false )
		MoveToFlagEnabled( SCMD02, false )
		MoveToFlagEnabled( SCMD03, false )
		MoveToFlagEnabled( SCMD04, false )
		MoveToFlagEnabled( SCMD05, false )
		WriteRoleValue( SCMD01, EM_RoleValue_IsWalk , 1  )
		WriteRoleValue( SCMD02, EM_RoleValue_IsWalk , 1  )
		WriteRoleValue( SCMD03, EM_RoleValue_IsWalk , 1  )
		WriteRoleValue( SCMD04, EM_RoleValue_IsWalk , 1  )
		WriteRoleValue( SCMD05, EM_RoleValue_IsWalk , 1  )
		Sleep(40)
		AddToPartition( SCMD01, 0 )
		NpcSay( SCMD01, "[SC_425212_01]" ) Sleep(40)
		NpcSay( SCMD01, "[SC_425212_02]" ) Sleep(40)
		AddToPartition( SCMD02, 0 )
		DelObj(SCMD01)
		NpcSay( SCMD02, "[SC_425212_03]" ) Sleep(40)
		AddToPartition( SCMD03, 0 )
		DelObj(SCMD02)
		NpcSay( SCMD03, "[SC_425212_04]" ) Sleep(40)
		NpcSay( SCMD03, "[SC_425212_05]" ) Sleep(40)
		DelObj(SCMD03)
		AddToPartition( SCMD04, 0 )
		NpcSay( SCMD04, "[SC_425212_06]" ) Sleep(40)
		NpcSay( SCMD04, "[SC_425212_07]" ) Sleep(40)
		NpcSay( SCMD04, "[SC_425212_08]" ) Sleep(40)		
		AddToPartition( SCMD05, 0 )
		DelObj(SCMD04)
		NpcSay( SCMD05, "[SC_425212_09]" ) Sleep(40)
		NpcSay( SCMD05, "[SC_425212_10]" ) Sleep(40)
		DelObj(SCMD05)
	end
	local Player={}
	Player=SearchRangePlayer ( OwnerID() , 150 )		
		for i= 0, table.getn(Player), 1 do
			if	CheckAcceptQuest( Player[i], 425212)==TRUE and
				CheckFlag( Player[i], 546294)==False then
				GiveBodyItem( Player[i], 546294, 1 )
			end
		end
	WriteRoleValue( OwnerID(), EM_RoleValue_Register1, 0 )
end
------------------------------------------------------------------------
function Z23_Quest425212_04()
	local NPC={}
	local ACT={}
	NPC=SearchRangeNPC ( OwnerID(), 100 )
		for i=0,table.getn(NPC) do
			if ReadRoleValue( NPC[i] , EM_RoleValue_OrgID)==120780 then
				ACT[1]=NPC[i]		
			elseif ReadRoleValue( NPC[i] , EM_RoleValue_OrgID)==120827 then
				ACT[2]=NPC[i]
			elseif ReadRoleValue( NPC[i] , EM_RoleValue_OrgID)==120830 then
				ACT[3]=NPC[i]
			elseif ReadRoleValue( NPC[i] , EM_RoleValue_OrgID)==120831 then
				ACT[4]=NPC[i]
				NpcSay( ACT[4], "[SC_425212_11]" ) 
			end
		end
	for i=1, 4, 1 do
		MoveToFlagEnabled( ACT[i], false )
	end
	FaceFlag( ACT[1], 781153, 2 ) AdjustDir( ACT[1], 0 )
	FaceFlag( ACT[2], 781153, 4 ) AdjustDir( ACT[2], 0 )
	FaceFlag( ACT[3], 781153, 1 ) AdjustDir( ACT[3], 0 )
	FaceFlag( ACT[4], 781153, 5 ) AdjustDir( ACT[4], 0 )
	Sleep(450)
	for i=1, 4, 1 do
		FaceFlag( ACT[i], 781153, 6 )
		AdjustDir( ACT[i], 0 )
	end
end
------------------------------------------------------------------------Á{¦M¨ü©R
function Z23_NPC120273_01()--©¬´¶¡D»®¯Á¤Ò
	LoadQuestOption( OwnerID() )
	if 	CheckAcceptQuest( OwnerID(), 425213)==TRUE and
		CheckFlag( OwnerID(), 546295)==False then
		AddSpeakOption( OwnerID(), TargetID( ), GetString("SC_425213_00"), "Z23_Quest425213_00", 0 )
	end
	CloseSpeak( OwnerID() )
end
------------------------------------------------------------------------
function Z23_Quest425213_00()
	if 	CheckAcceptQuest( OwnerID(), 425213)==TRUE and
		CheckFlag( OwnerID(), 546295)==False then
		GiveBodyItem( OwnerID(), 546295, 1 )
	end
	CloseSpeak( OwnerID() )
end
------------------------------------------------------------------------¤Ñ¥­¨âºİ
function Z23_NPC120833_00()--¼¯·ç§J¡D´ìªL¯S
	SetPlot( OwnerID(),"range","Z23_Quest425218_00",100 )
end
------------------------------------------------------------------------
function Z23_Quest425218_00()
	if CheckAcceptQuest( OwnerID(), 425218)==TRUE then
		GiveBodyItem( OwnerID(), 546296, 1 )
	end
end
------------------------------------------------------------------------
function Z23_NPC120833_01()
	if CheckAcceptQuest( OwnerID(), 425218)==TRUE then
		GiveBodyItem( OwnerID(), 546296, 1 )
	end
	LoadQuestOption( OwnerID() )
end
------------------------------------------------------------------------
function Z23_Quest425218_01()
	AddBuff ( TargetID(), 623344, 0, 16 )
	DelBodyItem( TargetID(), 546520, 1 )
	SetScriptFlag( TargetID(), 546510, 1 )
	if ReadRoleValue( OwnerID(), EM_RoleValue_Register1)==0 then
		WriteRoleValue( OwnerID(), EM_RoleValue_Register1, 1 )
		SetModeEx( OwnerID(), EM_SetModeType_ShowRoleHead, False )
		local NPC=LuaFunc_CreateObjByObj ( 120859, OwnerID() )
		MoveToFlagEnabled( NPC, false )
		Sleep(10)
		SetModeEx( OwnerID(), EM_SetModeType_ShowRoleHead, True )
		AddToPartition( NPC, 0 )
		WriteRoleValue( NPC, EM_RoleValue_IsWalk ,1)
		LuaFunc_MoveToFlag( NPC, 781165, 0, 0 )
		Sleep(10)
		NpcSay( NPC, "[SC_425218_01]" )
		WriteRoleValue( NPC, EM_RoleValue_IsWalk ,0)
		Sleep(30)
		LuaFunc_MoveToFlag( NPC, 781165, 1, 0 )
		Sleep(10)
		NpcSay( NPC, "[SC_425218_02]" )
		Sleep(10)
		CallPlot( NPC, "Z23_NPC120859_01",NPC )
		LuaFunc_MoveToFlag( NPC, 781147, 0, 0 )
		Sleep(10)
		WriteRoleValue( OwnerID(), EM_RoleValue_Register1, 0 )
	else return
	end
end
------------------------------------------------------------------------
function Z23_NPC120859_01()
	Sleep(15)
	DelObj( OwnerID() )
end
------------------------------------------------------------------------
function Z23_Quest425218_02()
	Lua_ZonePE_3th_GetScore(50)
	SetScriptFlag( TargetID(), 546511, 1 )
	if ReadRoleValue( OwnerID(), EM_RoleValue_Register1)==0 then
		AddBuff ( TargetID(), 622652, 0, 65 )
		CallPlot( OwnerID(), "Z23_Quest425218_03", TargetID() )
	else	local Time=ReadRoleValue( OwnerID(), EM_RoleValue_Register2)
		AddBuff ( TargetID(), 622652, 0, Time)
	end
	CloseSpeak( TargetID() )
	SetModeEx( OwnerID(), EM_SetModeType_ShowRoleHead, False )
	DelBodyItem( TargetID(), 546510, 1 )
	DelBodyItem( TargetID(), 546520, 1 )
end
------------------------------------------------------------------------
function Z23_Quest425218_03(Player)
	local Jill
	local Loub
	local Light
	local Dragon
	local Fighter1
	local Fighter2
	local Fxball01
	local Fxball02
	local NPC={}
	WriteRoleValue( OwnerID(), EM_RoleValue_Register, 1 )
	DisableQuest( OwnerID() , False )
	MoveToFlagEnabled( OwnerID(), False )
	CallPlot( OwnerID(), "Z23_Quest425218_04", OwnerID() )
	NPC=SearchRangeNPC ( OwnerID(), 200 )
	for i=0,table.getn(NPC) do
		if ReadRoleValue( NPC[i] , EM_RoleValue_OrgID)==120834 then
			Jill=NPC[i]--¦N¨à
			MoveToFlagEnabled( Jill, False )
			WriteRoleValue( Jill, EM_RoleValue_IsWalk ,0)		
		elseif ReadRoleValue( NPC[i] , EM_RoleValue_OrgID)==120835 then
			Loub=NPC[i]--³Ò«k
		elseif ReadRoleValue( NPC[i] , EM_RoleValue_OrgID)==120902 then
			if Fighter1==nil then 
				Fighter1=NPC[i]
			else 	Fighter2=NPC[i]
			end
		end
	end
	Light=CreateObjByFlag( 120782, 781165, 2, 1 )
	MoveToFlagEnabled( Light, false )
	AdjustFaceDir( Jill, Fighter1, 0 )
	Sleep(10)
	SetModeEx( OwnerID(), EM_SetModeType_ShowRoleHead, True )
	NpcSay( Jill, "[SC_425218_12]" )--§ÖÅı¶}¡A§Ú¨Ã¤£·Q¶Ë®`§A­Ì¡I
	PlayMotion( Jill, ruFUSION_ACTORSTATE_EMOTE_POINT )
	Sleep(20)
	NpcSay( Fighter1, "[SC_425218_11]" )--¥L®`¦º¤F§Ú­Ìªº¹Ù¦ñ¡A§Ú­Ì¤£·|Åı©p´N³o¼Ë±N¥L±a¨«¡I
	Sleep(20)
	Lua_StopBGM(Player)
	local DragonMc=PlayMusicToPlayer(player,"music/GuildWar/epic_tales_02_JFL_hellwars.mp3", false )--¥úÀs¥X³õ­µ¼Ö
	Sleep(10)
	ScriptMessage( OwnerID(), Player, 2, "[SC_425218_03]", C_SYSTEM )--¥úÀs¤Æ¨­¬°¤H§Î¡A¨Ó¨ì¤FÁp·ù¾n¦a....
	Sleep(20)
	AddToPartition( Light, 0 )
	Sleep(15)
	NpcSay( Light, "[SC_425218_04]" )--¬İ¨Ó¡A§Ú§ä¨ì¤F³y¦¨¤¸¯À¤£Ã­©wªº­ì¦]....
	Sleep(20)
	LuaFunc_MoveToFlag( Light, 781165, 3, 0 )
	Sleep(05)
	AdjustFaceDir(OwnerID(), Light, 0)
	Sleep(05)
	NpcSay( OwnerID(), "[SC_425218_15]" )--¥úÀs......
	Sleep(10)
	NpcSay( Light, "[SC_425218_05]" )--¶â....§Ú§Æ±æ§A­Ì¯à°÷²z¸Ñ....
	Sleep(25)
	NpcSay( Light, "[SC_425218_06]" )--³o«Ä¤lÅé¤º©Ò¼çÂÃªº¤O¶q¨ã¦³·´·À©Ê¡A¦]¦¹....
	Sleep(25)
	NpcSay( Light, "[SC_425218_14]" )--§Ú¤£±o¤£°µ¥X¨M©w....
	Sleep(15)
	Fxball01=LuaFunc_CreateObjByObj ( 120895, Loub )
	CastSpell( Light, Fxball01, 850236 )
	AdjustFaceDir(OwnerID(), Loub, 0)
	Sleep(10)
	AddBuff ( Fxball01, 622683, 1, -1 )
	ScriptMessage( OwnerID(), Player, 2, "[SC_425218_16]", C_SYSTEM )--¦¹®É...¥úÀs¶}±Ò¤F«Ê¦Lªk°}......
	AdjustFaceDir(Jill, Light, 0)
	Sleep(05)
	PlayMotion( Jill, ruFUSION_ACTORSTATE_EMOTE_POINT )
	Sleep(05)
	NpcSay( Jill, "[SC_425218_07]" )--§Ö¦í¤â¡A§A­n¹ï³Ò«k°µ¤°»ò¡I¡H
	Sleep(10)
	AdjustFaceDir(Fighter1, Light, 0)
	AdjustFaceDir(Fighter2, Light, 0)
	CastSpell( Loub, Loub, 850237 )
	Sleep(20)
	AdjustFaceDir(Jill, Loub, 0)
	Sleep(65)
	CallPlot( Loub, "LuaFunc_ResetObj", Loub )
	Fxball02=LuaFunc_CreateObjByObj ( 120895, Light )
	AddBuff ( Fxball02, 622683, 1, -1 )
	DelObj( Fxball01 )
	NpcSay( Light, "[SC_425218_08]" )--¬°¤F¤£Åı¹L¥hªº¯E§T¦A¦¸­«ºt¡A§Ú¥²¶·±N³o«Ä¤l«Ê¦L¦b¥­¿Å¸t©Ò....
	Sleep(10)
	AdjustFaceDir(OwnerID(), Light, 0)
	Sleep(20)
	ScriptMessage( OwnerID(), Player, 2, "[SC_425218_17]", C_SYSTEM )--¥úÀs±N¨ü¨ì«Ê¦Lªº[115891]¤@¦P±a¦^¤F[ZONE_BALENCETEMPLE]......
	Sleep(15)
	DelObj( Light )
	Sleep(15)
	DelObj( Fxball02 )
	Sleep(30)
	LuaFunc_MoveToFlag( Jill, 781165, 4, 0 )
	AdjustFaceDir(Fighter1, Jill, 0)
	AdjustFaceDir(Fighter2, Jill, 0)
	AdjustFaceDir(OwnerID(), Jill, 0)
	Sleep(20)
	NpcSay( Jill, "[SC_425218_13]" )--³Ò«k........
	Sleep(20)
	PlayMotion( Jill, ruFUSION_ACTORSTATE_EMOTE_ANGRY)
	Sleep(20)
	AdjustFaceDir(Jill, OwnerID(), 0)
	Sleep(10)
	PlayMotion( Jill, ruFUSION_ACTORSTATE_EMOTE_POINT )
	AdjustFaceDir(OwnerID(), Jill, 0)
	NpcSay( Jill, "[SC_425218_09]" )--§A­Ì....³o¸s¤H....¡A³ºµM³£µL°Ê©ó°J....
	Sleep(30)
	NpcSay( Jill, "[SC_425218_10]" )--¦pªG....§Ú¦A¤]¨£¤£¨ì³Ò«k¡A§Ú±N»P§A­Ì©Ò¦³¤H»}¤£¨â¥ß¡I
	PlayMotion( Jill, ruFUSION_ACTORSTATE_EMOTE_POINT )
	Sleep(20)
	PlayMotion( Jill, ruFUSION_ACTORSTATE_EMOTE_ANGRY)
	Sleep(30)
	SetDefIdleMotion( Jill, ruFUSION_MIME_RUN_FORWARD)
	LuaFunc_MoveToFlag( Jill, 781165, 5, 0 )
	CallPlot( Jill, "LuaFunc_ResetObj", Jill )
	CallPlot( Fighter1, "LuaFunc_ResetObj", Fighter1 )
	CallPlot( Fighter2, "LuaFunc_ResetObj", Fighter2)
	StopSound(Player, DragonMc)
	Lua_PlayBGM(Player)
	WriteRoleValue( OwnerID(), EM_RoleValue_Register, 0 )
end
------------------------------------------------------------------------
function Z23_Quest425218_04()
	local Num=64
	for i =1, 64, 1 do
		Num=Num-1
		WriteRoleValue( OwnerID(), EM_RoleValue_Register2, Num )
	Sleep(10)
	end
end
------------------------------------------------------------------------
function Z23_NPC120834_00()
	SetDefIdleMotion( OwnerID(), ruFUSION_MIME_IDLE_STAND)
	MoveToFlagEnabled(OwnerID(), False ) 
end
------------------------------------------------------------------------
function Z23_NPC120835_00()
	MoveToFlagEnabled(OwnerID(), False )
	SetDefIdleMotion(OwnerID(),ruFUSION_MIME_DEATH_LOOP)
	AddBuff( OwnerID(), 620135, 0, -1 )
end
------------------------------------------------------------------------
function Z23_NPC120895_00()
	AddBuff ( OwnerID(), 622683, 1, -1 )
end
------------------------------------------------------------------------
function Z23_NPC120902_00()
	MoveToFlagEnabled(OwnerID(), False )
	PlayMotionEX( OwnerID(),ruFUSION_ACTORSTATE_COMBAT_1H, ruFUSION_ACTORSTATE_COMBAT_1H)
	Sleep(10)
	local NPC={}
	NPC=SearchRangeNPC(OwnerID(), 100)
		for i=0,table.getn(NPC) do
			if ReadRoleValue( NPC[i] , EM_RoleValue_OrgID)==120834 then
				Jill=NPC[i]
			end
		end
	AdjustFaceDir( OwnerID(), Jill, 0 )
end
------------------------------------------------------------------------¥¢±±Ãä½t
function Z23_Quest425219_00()
	Lua_ZonePE_3th_GetScore(50)
	if CheckFlag( TargetID(), 546511)==True then
		DelBodyItem( TargetID(), 546511, 1 )
	end
end
------------------------------------------------------------------------
Function Z23_NPCAngerAll_00()
	while 1 do
		CastSpell( OwnerID(), OwnerID(), 499256 )
	Sleep(20) 
	end
End
------------------------------------------------------------------------
Function Z23_Quest425219_01()
	DelBodyItem( OwnerID(), 546520 )
End
------------------------------------------------------------------------ÀË¬d©¬©_¹«
function Z23_DeMagicCavy_00()
	local num=0
	local npc={106473, 106611, 106612, 106613, 106614, 106617, 106620, 106615, 106616, 106676 }
		for i=1,table.getn(npc) do
			if ReadRoleValue( TargetID(), EM_RoleValue_OrgID)==npc[i] then
				num=num+1
			end
		end
		if num>0 then
			SetFlag( OwnerID(), 544801, 1 )--Ãö³¬©¬©_¹«
		else	SetFlag( OwnerID(), 544801, 0 )--¶}±Ò©¬©_¹«
		end
end
------------------------------------------------------------------------µ¹¤©¼Ğ°O¥ÎBuff622649
function Z23_GetItem546293_00()
	Lua_ZonePE_3th_GetScore(1)
	if ReadRoleValue( OwnerID(), EM_RoleValue_Register1)==1 then
		local PlayerID=HateListCount( OwnerID() )
		for i=0, PlayerID, 1 do
			local ID=HateListInfo( OwnerID() , i, EM_HateListInfoType_GItemID )
			if CheckAcceptQuest( ID, 425211 )==true then
				local num=rand(2)
				AddBuff ( ID, 622649, num, -1 )
				local Count=Lua_BuffPosSearch( ID, 622649)
				if BuffInfo( ID, Count, EM_BuffInfoType_Power )>=9 then
					SetFlag( ID, 546293, 1 )
					CancelBuff( ID, 622649)
					DelBodyItem( ID, 546508, 1 )
				end
			end
		end
	end
end
------------------------------------------------------------------------
function Z23_CAST623350_00()
	SetScriptFlag( OwnerID(), 546520, 1 )
end
------------------------------------------------------------------------
Function Z23_WMBugChecking_00()
	local BUG=OwnerID()
	local RG1=ReadRoleValue( BUG, EM_RoleValue_Register1 )
	local RG2=ReadRoleValue( BUG, EM_RoleValue_Register2 )
	DebugMsg( 0, 0, "RG1="..RG1..",RG2="..RG2 )
end
------------------------------------------------------------------------